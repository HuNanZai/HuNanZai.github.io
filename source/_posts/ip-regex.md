---
title: 用正则表达式匹配ip地址
date: 2016-05-17 10:28:43
tags: [正则, ip]
---

# 前言

使用正则匹配的关键在于弄清楚问题的表征  

在这里问题的表征具体为ip地址的表示方式

# 关于ip

这里的ip特指ipv4

## 定义

 - [传送门](https://zh.wikipedia.org/wiki/IP%E5%9C%B0%E5%9D%80#IPv4.E4.BD.8D.E5.9D.80)

## 特征

 - 32位 4段 每一段0-255
 - 分为A\B\C\D\E 5大类

# 正则

## 基础知识

[传送门][microsoft_regex]

- 匹配0-9: [0-9]
- 匹配多个: []{times}
- 条件或者: ()|()

## 如何匹配ip

根据ip每一段的范围为0-255来提取

0-255 总共分为5部分:
```
	0-9: [0-9]
	10-99: [1-9][0-9]
	100-199: 1[0-9][0-9]
	200-249: 2[0-4][0-9]
	250-255: 25[0-5]
```

得到的ip表达式:
```
抽象表达:
([regex:255]\.){3}([regex:255])

代入上面的汇总结果得到:
/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))$/
```

# 总结
php中利用正则匹配ip的函数:
```php
function checkIp($str)
{
	return preg_match('/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))$/', $str) ? true : false;
}

echo checkIp('0.0.0.0') ? 'true' : 'false';		//true
echo checkIp('192.168.0.1') ? 'true' : 'false';		//true
echo checkIp('255.255.255.0') ? 'true' : 'false';	//true
echo checkIp('256.0.0.1') ? 'true' : 'false';		//false
```

## 思考
1. ip地址形式如果可以为 003.012.022.222 这种开头带0的怎么办?
2. 如果要严格匹配A|B|C|D|E 5大类ip怎么办？

[microsoft_regex]:https://msdn.microsoft.com/zh-cn/library/ae5bf541(VS.80).aspx